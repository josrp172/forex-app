<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: The Basics (Taglish Edition)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Chapter Specific Styles */
        body {
            overflow-y: auto;
            padding-bottom: 50px;
            /* Richer Warm Gradient */
            background: linear-gradient(135deg, #fffbf0 0%, #ffcc80 100%);
            font-family: 'Outfit', sans-serif;
            color: #2c3e50;
            min-height: 100vh;
        }

        .chapter-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            padding-bottom: 200px;
        }

        .nav-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
            z-index: 10;
        }

        .home-link {
            text-decoration: none;
            color: #5d4037;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: 0.3s;
            background: rgba(255, 255, 255, 0.6);
            padding: 10px 20px;
            border-radius: 30px;
            backdrop-filter: blur(5px);
        }

        .home-link:hover {
            color: #d35400;
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(-5px);
        }

        .next-chapter-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 18px 40px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 800;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .next-chapter-btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 30px rgba(46, 204, 113, 0.4);
        }

        /* Glass / Card Styling */
        .section-card {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 35px;
            padding: 50px;
            box-shadow: 0 20px 50px rgba(93, 64, 55, 0.1);
            animation: fadeInUp 0.8s cubic-bezier(0.22, 1, 0.36, 1);
            margin-bottom: 40px;
            position: relative;

            /* Focus Animation Props */
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            transform: scale(0.98);
            opacity: 0.85;
            border-left: 5px solid transparent;
        }

        .section-card.focused {
            transform: scale(1.02);
            opacity: 1;
            box-shadow: 0 40px 70px rgba(211, 84, 0, 0.15),
                0 10px 10px rgba(0, 0, 0, 0.05);
            /* Deep Glow */
            border-color: rgba(255, 255, 255, 0.95);
            border-radius: 35px;
            /* Ensure radius matches */
            border-left: 5px solid #ff7043;
            /* Highlight Indicator */
            z-index: 10;
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 35px;
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);
            pointer-events: none;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-size: 3.5rem;
            background: linear-gradient(45deg, #d35400, #e67e22);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 10px;
            font-weight: 900;
            letter-spacing: -1px;
            filter: drop-shadow(0 2px 0px rgba(255, 255, 255, 0.5));
        }

        .subtitle {
            text-align: center;
            color: #8d6e63;
            margin-bottom: 50px;
            font-size: 1.3rem;
            font-weight: 500;
        }

        h2 {
            font-size: 1.8rem;
            color: #5d4037;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        h2::before {
            content: '';
            display: block;
            width: 8px;
            height: 35px;
            background: #ffab91;
            border-radius: 4px;
        }

        p {
            line-height: 1.8;
            color: #4a4a4a;
            font-size: 1.15rem;
            margin-bottom: 20px;
        }

        /* Scenario Box */
        .scenario-box {
            background: #fffcf5;
            border: 2px dashed #ffe082;
            padding: 25px;
            border-radius: 20px;
            margin: 30px 0;
            font-size: 1.1rem;
            color: #795548;
            position: relative;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.03);
            transition: transform 0.3s;
        }

        .scenario-box:hover {
            transform: scale(1.02);
            background: #fffDE7;
        }

        /* Currency Visuals */
        .currency-pair {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 40px 0;
            background: white;
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.08);
            border: 1px solid #eee;
        }

        .currency {
            text-align: center;
            transition: transform 0.3s;
        }

        .currency:hover {
            transform: translateY(-10px);
        }

        .flag-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border: 4px solid white;
        }

        /* Using CSS gradients for clean flags */
        .jp-flag {
            background: radial-gradient(circle, #bc002d 40%, #ffffff 41%);
        }

        .ph-flag {
            background: linear-gradient(180deg, #0038a8 50%, #ce1126 50%);
            position: relative;
            overflow: hidden;
            /* Ensure content stays in circle */
        }

        .ph-flag::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 40%;
            background: #fff;
            clip-path: polygon(0 0, 100% 50%, 0 100%);
        }

        /* Sun (Simple yellow circle for representation) */
        .ph-flag::before {
            content: '';
            position: absolute;
            left: 5%;
            top: 50%;
            transform: translateY(-50%);
            width: 15%;
            height: 15%;
            background: #fcd116;
            border-radius: 50%;
            z-index: 2;
        }

        .rate-display {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .rate-sub {
            font-size: 0.9rem;
            color: var(--text-muted);
            text-align: center;
        }

        /* Candlestick Anatomy */
        .candle-anatomy {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 40px 0;
        }

        .candle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;
        }

        .candle {
            width: 20px;
            height: 100px;
            position: relative;
            background: #2ecc71;
            /* Green */
            border-radius: 2px;
            margin: 60px 0;
            /* Clear labels */
        }

        .candle.red {
            background: #e74c3c;
            /* Red */
        }

        .wick {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            background: #000;
            z-index: -1;
        }

        .wick.top {
            top: -30px;
            height: 30px;
        }

        .wick.bottom {
            bottom: -30px;
            height: 30px;
        }

        .label {
            font-size: 0.8rem;
            color: #888;
            position: absolute;
            width: 100px;
            text-align: center;
        }

        .label.high {
            top: -50px;
        }

        .label.low {
            bottom: -50px;
        }

        /* Next Button */
        .next-chapter-btn {
            display: block;
            width: 100%;
            text-align: center;
            background: var(--text-dark);
            color: white;
            padding: 20px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: bold;
            transition: transform 0.3s, background 0.3s;
        }

        .next-chapter-btn:hover {
            transform: translateY(-5px);
            background: var(--accent-color);
        }

        .highlight {
            background: #ffecb3;
            padding: 0 4px;
            border-radius: 4px;
        }

        /* Seesaw Animation */
        .seesaw-container {
            position: relative;
            width: 100%;
            height: 220px;
            /* Increased height significantly to prevent overlap */
            margin-top: 20px;
        }

        .seesaw-plank {
            width: 80%;
            height: 8px;
            background: #555;
            position: absolute;
            top: 120px;
            /* Moved down to give space for boxes above */
            left: 10%;
            border-radius: 4px;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1;
        }

        .seesaw-pivot {
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 40px solid #888;
            position: absolute;
            top: 128px;
            /* Positioned right below the plank */
            left: 50%;
            transform: translateX(-50%);
            z-index: 0;
        }

        .seesaw-box {
            width: 60px;
            height: 60px;
            position: absolute;
            bottom: 100%;
            /* Sits exactly on top of the plank */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 10px;
            font-size: 0.9rem;
            color: white;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.5s;
            margin-bottom: 2px;
        }

        .box-left {
            left: 0;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .box-right {
            right: 0;
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        /* Initial State: JPY High, PHP Low */
        .plank-tilted-left {
            transform: rotate(-15deg);
        }

        .plank-tilted-right {
            transform: rotate(15deg);
        }

        /* Button Styles */
        .tilt-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
            font-size: 1rem;
            flex: 1;
        }

        .tilt-btn:active {
            transform: scale(0.95);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .terms-grid {
                grid-template-columns: 1fr;
            }

            .currency-pair {
                flex-direction: column;
                gap: 20px;
            }

        }
    </style>
</head>

<body>

    <div class="chapter-container">
        <!-- Header -->
        <header class="nav-header">
            <a href="{{ url_for('index', _anchor='map') }}" class="home-link">
                <span>‚Üê</span> Back to Map
            </a>
            <div style="text-align: right;">
                <span style="font-size: 0.8rem; color: #aaa; text-transform: uppercase; letter-spacing: 1px;">Chapter
                    1</span>
                <h1 style="margin: 0; font-size: 1.5rem; color: #d35400;">The Money Talk üí∏</h1>
            </div>
        </header>

        <!-- Intro Text replaced below header -->
        <div style="text-align: center; margin-bottom: 40px;">
            <p class="subtitle" style="margin:0;">Ating alamin kung paano gumagalaw ang pera... ready ka na bang kiligin
                sa profits? üòè</p>
        </div>

        <!-- Section 1: The Scenario (Interactive Simulator) -->
        <div class="section-card">
            <h2>üåç 1. The "Sahod" Simulator</h2>
            <div class="scenario-box">
                <p><strong>Scenario:</strong> Isipin mo, ikaw ang ultimate <strong>"Human Calculator"</strong>. Kada
                    galaw ng rate, judge mo agad‚ÄîSulit ba o Scam? Let's check the vibes.</p>
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 20px;">Tignan ang vibe sa pagitan ng
                    <strong>Real-Time Data</strong> at ng iyong <strong>Dream Rate</strong> sa baba. Yung gap? Yan ang
                    opportunity mo.
                </p>

                <!-- Flags & Conversion Display -->
                <div class="currency-pair"
                    style="margin: 20px 0; padding: 15px; background: white; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: space-around;">
                    <div class="currency">
                        <div class="flag-circle jp-flag"></div>
                        <div style="font-weight:bold;">10,000 JPY</div>
                    </div>

                    <div style="text-align: center;">
                        <div style="font-size: 2rem;">üëâ</div>
                        <!-- LIVE RATE FIXED BADGE -->
                        <div style="margin-top:5px;">
                            <div id="live-rate-badge"
                                style="background:#555; color:white; font-size:0.75rem; padding: 4px 10px; border-radius: 10px; font-weight: bold; letter-spacing: 1px;">
                                LOADING...</div>
                            <div id="live-converted"
                                style="color: #555; font-size: 0.8rem; margin-top: 3px; font-weight: bold;">(‚âà --- PHP)
                            </div>
                        </div>
                    </div>

                    <div class="currency">
                        <div class="flag-circle ph-flag"></div>
                        <div id="php-result"
                            style="font-size: 1.5rem; font-weight:bold; color: #27ae60; transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                            ---</div>
                        <div id="diff-badge"
                            style="font-size: 0.85rem; font-weight: bold; padding: 2px 8px; border-radius: 10px; margin-top: 5px; opacity: 0; transition: opacity 0.3s;">
                            + ‚Ç±0.00</div>
                        <small style="color:#999;">Simulated Value</small>
                    </div>
                </div>

                <!-- Slider Control -->
                <div
                    style="padding: 15px; background: #fffbe6; border-radius: 15px; border: 1px solid #ffe082; text-align:center;">
                    <label style="font-size: 0.9rem; color: #777;">Dream Rate Slider: <span id="rate-display"
                            style="color:#d35400; font-weight:bold;">---</span></label>
                    <input type="range" id="rate-slider" min="0.30" max="0.45" step="0.001" value="0.38"
                        style="width: 100%; margin: 15px 0; cursor: pointer; accent-color: #d35400;"
                        oninput="updateRemittance()">
                    <p id="remittance-comment"
                        style="font-size: 0.95rem; font-weight: bold; color: #555; margin:0; min-height: 25px;">
                        Galawin ang slider!
                    </p>
                </div>
            </div>

            <p>Sa Forex, <strong>para tayong nag-i-stalk ng ex</strong>. Isa lang ang tanong: Nag-glow up ba (Buy) o
                nag-crash (Sell)?</p>
        </div>

        <!-- Section 2: Reading Price (Candlesticks) -->
        <div class="section-card">
            <h2>üïØÔ∏è 2. The Battle: Buyers vs Sellers</h2>
            <p>Gamit natin ang <strong>Japanese Candlesticks</strong> para makita ang drama. Sino ang lamang? Ang mga
                romantic na Buyers o ang mga bitter na Sellers? üïØÔ∏è</p>

            <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 50px;">

                <!-- Bullish Card -->
                <div
                    style="background: white; padding: 20px; border-radius: 20px; border: 2px solid #2ecc71; text-align: center; flex: 1; min-width: 200px; box-shadow: 0 5px 15px rgba(46, 204, 113, 0.1);">
                    <h3 style="color: #2ecc71; margin-bottom: 30px;">Buyers Win (Green) üíö</h3>
                    <div style="position: relative; height: 160px; width: 40px; margin: 0 auto;">
                        <div
                            style="position: absolute; top: 0; left: 19px; width: 2px; height: 160px; background: #555;">
                        </div> <!-- Wick -->
                        <div
                            style="position: absolute; bottom: 40px; left: 0; width: 40px; height: 80px; background: #2ecc71; border-radius: 4px; z-index: 2;">
                        </div> <!-- Body -->

                        <!-- Labels (Fixed Positioning) -->
                        <div
                            style="position: absolute; top: -20px; left: -60px; font-size: 0.7rem; color: #888; width: 60px; text-align: right;">
                            Highest (Dulo)</div>
                        <div
                            style="position: absolute; bottom: 35px; right: -70px; font-size: 0.7rem; color: #2ecc71; font-weight: bold; width: 65px; text-align: left;">
                            OPEN (Start)</div>
                        <div
                            style="position: absolute; top: 35px; right: -70px; font-size: 0.7rem; color: #2ecc71; font-weight: bold; width: 65px; text-align: left;">
                            CLOSE (End)</div>
                    </div>
                    <p style="font-size: 0.9rem; margin-top: 30px; color: #555;">Price went <strong>UP</strong> üöÄ
                        <br><span style="font-size:0.8rem; color:#888;">(Nag-start sa baba, natapos sa taas)</span>
                    </p>
                </div>

                <!-- Bearish Card -->
                <div
                    style="background: white; padding: 20px; border-radius: 20px; border: 2px solid #e74c3c; text-align: center; flex: 1; min-width: 200px; box-shadow: 0 5px 15px rgba(231, 76, 60, 0.1);">
                    <h3 style="color: #e74c3c; margin-bottom: 30px;">Sellers Win (Red) üö©</h3>
                    <div style="position: relative; height: 160px; width: 40px; margin: 0 auto;">
                        <div
                            style="position: absolute; top: 0; left: 19px; width: 2px; height: 160px; background: #555;">
                        </div> <!-- Wick -->
                        <div
                            style="position: absolute; top: 40px; left: 0; width: 40px; height: 80px; background: #e74c3c; border-radius: 4px; z-index: 2;">
                        </div> <!-- Body -->

                        <!-- Labels (Fixed Positioning) -->
                        <div
                            style="position: absolute; bottom: -20px; left: -60px; font-size: 0.7rem; color: #888; width: 60px; text-align: right;">
                            Lowest (Dulo)</div>
                        <div
                            style="position: absolute; top: 35px; right: -70px; font-size: 0.7rem; color: #e74c3c; font-weight: bold; width: 65px; text-align: left;">
                            OPEN (Start)</div>
                        <div
                            style="position: absolute; bottom: 35px; right: -70px; font-size: 0.7rem; color: #e74c3c; font-weight: bold; width: 65px; text-align: left;">
                            CLOSE (End)</div>
                    </div>
                    <p style="font-size: 0.9rem; margin-top: 30px; color: #555;">Price went <strong>DOWN</strong> üìâ
                        <br><span style="font-size:0.8rem; color:#888;">(Nag-start sa taas, bumagsak sa huli)</span>
                    </p>
                </div>

            </div>

            <!-- New Real Life Chart Section -->
            <div style="margin-top: 40px; padding-top: 30px; border-top: 1px dashed #ddd;">
                <h3 style="text-align: center; color: #555; margin-bottom: 10px;">üìä In Real Life (The Chart)</h3>
                <p style="text-align: center; font-size: 0.9rem; color: #888; margin-bottom: 20px;">Pag pinagsama-sama
                    mo ang mga candlesticks, gumagawa sila ng "Kwento" (Trend).</p>

                <div
                    style="position: relative; height: 200px; background: #fdfdfd; border: 1px solid #eee; border-radius: 10px; display: flex; align-items: flex-end; justify-content: center; gap: 8px; padding-bottom: 20px; overflow: hidden;">

                    <!-- Chart Grid Background -->
                    <div style="position: absolute; top: 25%; width: 100%; border-top: 1px dashed #f0f0f0;"></div>
                    <div style="position: absolute; top: 50%; width: 100%; border-top: 1px dashed #f0f0f0;"></div>
                    <div style="position: absolute; top: 75%; width: 100%; border-top: 1px dashed #f0f0f0;"></div>

                    <!-- Candle 1: Up -->
                    <div
                        style="width: 12px; height: 30px; background: #2ecc71; margin-bottom: 30px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 40px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 2: Up (Higher) -->
                    <div
                        style="width: 12px; height: 40px; background: #2ecc71; margin-bottom: 50px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 50px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 3: Down (Retrace) -->
                    <div
                        style="width: 12px; height: 20px; background: #e74c3c; margin-bottom: 60px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 30px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 4: Up (Breakout) -->
                    <div
                        style="width: 12px; height: 50px; background: #2ecc71; margin-bottom: 55px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -8px; width: 2px; height: 66px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 5: Up -->
                    <div
                        style="width: 12px; height: 30px; background: #2ecc71; margin-bottom: 95px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 40px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 6: Down (Bearish Engulfing) -->
                    <div
                        style="width: 12px; height: 60px; background: #e74c3c; margin-bottom: 55px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 70px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 7: Down -->
                    <div
                        style="width: 12px; height: 30px; background: #e74c3c; margin-bottom: 35px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 40px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 8: Up (Recovery) -->
                    <div
                        style="width: 12px; height: 20px; background: #2ecc71; margin-bottom: 30px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 30px; background: #aaa;">
                        </div>
                    </div>

                    <!-- Candle 9: Up -->
                    <div
                        style="width: 12px; height: 40px; background: #2ecc71; margin-bottom: 40px; position: relative; border-radius: 2px;">
                        <div
                            style="position: absolute; left: 5px; top: -5px; width: 2px; height: 50px; background: #aaa;">
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Section 3: Long vs Short (MOVED and EXPANDED) -->
        <div class="section-card">
            <h2>üêÇ 3. The "Seesaw" Rule: Bet on the Strongest!</h2>
            <p>Confused paano kumita pag bumabagsak? <em>"Paano ako kikita pag down ang market?"</em></p>
            <p>Isipin mo na lang, parang <strong>Seesaw</strong>. Pag bumigat ang isa (Strong), lilipad ang kabila! Doon
                tayo uupo sa panalo.</p>

            <div class="seesaw-container">
                <div id="seesaw-plank" class="seesaw-plank plank-tilted-left">
                    <div class="seesaw-box box-left">JPY <br>üáØüáµ</div>
                    <div class="seesaw-box box-right">PHP <br>üáµüá≠</div>
                </div>
                <div class="seesaw-pivot"></div>
            </div>

            <p id="seesaw-text" style="text-align: center; margin-top: 20px; font-weight: bold; min-height: 60px;">
                Click a button above to see who gets heavy!
            </p>

            <!-- Chart Comparison Logic -->
            <div style="margin-top: 40px; border-top: 1px dashed #ddd; padding-top: 20px;">
                <h3 style="text-align: center; color: #555; margin-bottom: 20px;">üëÅÔ∏è The Chart Proof (Side-by-Side)
                </h3>

                <div style="display: flex; gap: 15px; flex-wrap: wrap;">

                    <!-- Chart A: Buying Base (Uptrend) -->
                    <div
                        style="flex: 1; min-width: 250px; background: #fdfdfd; border: 1px solid #eee; border-radius: 10px; padding: 15px;">
                        <div
                            style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; margin-bottom: 15px;">
                            <div class="flag-circle jp-flag" style="width: 35px; height: 35px;"></div>
                            <div style="font-weight: bold; color: #333; font-size: 1.1rem;">Japan (JPY)</div>
                        </div>
                        <div style="text-align: center; font-weight: bold; color: #2ecc71; margin-bottom: 5px;">LONG
                            (Buy) üìà</div>
                        <p style="font-size: 0.8rem; color: #777; text-align: center; margin-bottom: 15px;">Trusting
                            <strong>JAPAN</strong> (Left Side)
                        </p>

                        <!-- Mini Uptrend Chart -->
                        <div
                            style="height: 120px; position: relative; display: flex; align-items: flex-end; justify-content: center; gap: 5px;">
                            <div style="width: 8px; height: 20px; background: #2ecc71; margin-bottom: 10px;"></div>
                            <div style="width: 8px; height: 30px; background: #2ecc71; margin-bottom: 20px;"></div>
                            <div style="width: 8px; height: 15px; background: #e74c3c; margin-bottom: 25px;"></div>
                            <!-- Small dip -->
                            <div style="width: 8px; height: 40px; background: #2ecc71; margin-bottom: 30px;"></div>
                            <div style="width: 8px; height: 50px; background: #2ecc71; margin-bottom: 50px;"></div>
                            <div style="width: 8px; height: 60px; background: #2ecc71; margin-bottom: 70px;"></div>
                        </div>
                        <p style="font-size: 0.8rem; margin-top: 10px; text-align: center; color: #555;">Chart goes
                            <strong>UP</strong> because JPY is strong.
                        </p>
                    </div>

                    <!-- Chart B: Selling Base (Downtrend) -->
                    <div
                        style="flex: 1; min-width: 250px; background: #fdfdfd; border: 1px solid #eee; border-radius: 10px; padding: 15px;">
                        <div
                            style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; margin-bottom: 15px;">
                            <div class="flag-circle ph-flag" style="width: 35px; height: 35px;"></div>
                            <div style="font-weight: bold; color: #333; font-size: 1.1rem;">Philippines (PHP)</div>
                        </div>
                        <div style="text-align: center; font-weight: bold; color: #e74c3c; margin-bottom: 5px;">SHORT
                            (Sell) üìâ</div>
                        <p style="font-size: 0.8rem; color: #777; text-align: center; margin-bottom: 15px;">Trusting
                            <strong>PINAS</strong> (Right Side)
                        </p>

                        <!-- Mini Downtrend Chart -->
                        <div
                            style="height: 120px; position: relative; display: flex; align-items: flex-end; justify-content: center; gap: 5px;">
                            <div style="width: 8px; height: 60px; background: #e74c3c; margin-bottom: 70px;"></div>
                            <div style="width: 8px; height: 50px; background: #e74c3c; margin-bottom: 50px;"></div>
                            <div style="width: 8px; height: 15px; background: #2ecc71; margin-bottom: 55px;"></div>
                            <!-- Small pullup -->
                            <div style="width: 8px; height: 40px; background: #e74c3c; margin-bottom: 30px;"></div>
                            <div style="width: 8px; height: 30px; background: #e74c3c; margin-bottom: 20px;"></div>
                            <div style="width: 8px; height: 20px; background: #e74c3c; margin-bottom: 10px;"></div>
                        </div>
                        <p style="font-size: 0.8rem; margin-top: 10px; text-align: center; color: #555;">Chart goes
                            <strong>DOWN</strong> because PHP is strong.
                        </p>
                    </div>

                </div>
            </div>

            <div style="display: flex; gap: 20px; justify-content: center; margin-top: 20px;">
                <button onclick="tilt('left')" class="tilt-btn" style="background: #e74c3c;">
                    I trust JAPAN üáØüáµ<br>
                    <span style="font-size:0.8rem; font-weight:normal;">(Buy JPY / Sell PHP)</span>
                </button>
                <button onclick="tilt('right')" class="tilt-btn" style="background: #3498db;">
                    I trust PINAS üáµüá≠<br>
                    <span style="font-size:0.8rem; font-weight:normal;">(Buy PHP / Sell JPY)</span>
                </button>
            </div>

            <div id="seesaw-text"
                style="text-align: center; margin-top: 20px; font-weight: 500; color: #555; min-height: 50px; padding: 20px; background: #fffbe6; border: 1px solid #ffe082; border-radius: 10px;">
                Click a button to see who wins!
            </div>
        </div>

        <!-- Section 4: Lot Sizes & Pips -->
        <div class="section-card">
            <h2>üõí 4. The "Pip" & The "Lot" (Saan banda ang pera?)</h2>

            <!-- Part 1: Anatomy of a Pip -->
            <div
                style="background: #fff; border: 1px dashed #bbb; border-radius: 15px; padding: 20px; text-align: center; margin-bottom: 30px;">
                <h3 style="color: #555; margin-bottom: 15px;">Step 1: Spot the "Pip" (Ang Treasure) üîç</h3>
                <p style="font-size: 0.9rem; color: #777;">Sa JPY Pairs (tulad ng USD/JPY), ang treasure ay nasa
                    <strong>2nd Decimal</strong>. Yan ang "Pip"‚Äîang munting number na bumubuhay sa atin.
                </p>

                <div style="font-size: 2.5rem; font-weight: 700; color: #333; letter-spacing: 2px;">
                    154.2<span style="background: #ffeb3b; padding: 0 5px; border-radius: 4px; color: #d35400;">5</span>
                </div>
                <p style="font-size: 0.8rem; margin-top: 5px; color: #888;">Example Price: 154.25</p>

            </div>

            <div
                style="margin-top: 15px; font-size: 0.95rem; background: #e0f7fa; display: inline-block; padding: 10px 20px; border-radius: 20px;">
                Pag naging <strong>154.2<span style="color:#d35400; font-weight:bold;">6</span></strong>, that is
                <strong>+1 Pip Move</strong>.
            </div>


            <!-- Part 2: Lot Sizes -->
            <p>Step 2: Piliin ang "Taya" (Lot Size). Dito mo ilalagay kung magkano ang value ng bawat galaw na yan.</p>

            <div class="lot-size-container" style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px;">

                <!-- Micro -->
                <div class="lot-card"
                    style="border: 1px solid #ffecb3; padding: 15px; border-radius: 15px; background: #fffbe6; transition: transform 0.2s;">
                    <div style="display:flex; align-items:center; gap:20px; margin-bottom:10px;">
                        <div style="font-size: 2.5rem;">üç¨</div>
                        <div>
                            <h3 style="margin: 0; color: #f39c12;">Micro Lot (0.01)</h3>
                            <div
                                style="background: #333; color: #0f0; font-family: monospace; padding: 2px 8px; border-radius: 4px; display: inline-block; font-size: 0.8rem; margin-top: 4px;">
                                Input: 0.01</div>
                        </div>
                    </div>
                    <div style="font-size: 0.9rem; color: #555; margin-bottom: 10px;">
                        <strong>Value:</strong> $0.10 (‚Ç±6) per Pip.<br>
                        <em>Example: 154.25 ‚Üí 154.35 (10 Pips)</em>
                    </div>
                    <div
                        style="background: rgba(255,255,255,0.7); padding: 10px; border-radius: 8px; font-size: 0.95rem; display: flex; justify-content: space-between;">
                        <span style="color: #27ae60; font-weight: bold;">Profit: ‚Ç±60.00</span>
                        <span style="color: #7f8c8d;">(Presyong kape)</span>
                    </div>
                </div>

                <!-- Mini -->
                <div class="lot-card"
                    style="border: 1px solid #b3e5fc; padding: 15px; border-radius: 15px; background: #e3f2fd; transition: transform 0.2s;">
                    <div style="display:flex; align-items:center; gap:20px; margin-bottom:10px;">
                        <div style="font-size: 2.5rem;">üçî</div>
                        <div>
                            <h3 style="margin: 0; color: #2980b9;">Mini Lot (0.10)</h3>
                            <div
                                style="background: #333; color: #0f0; font-family: monospace; padding: 2px 8px; border-radius: 4px; display: inline-block; font-size: 0.8rem; margin-top: 4px;">
                                Input: 0.10</div>
                        </div>
                    </div>
                    <div style="font-size: 0.9rem; color: #555; margin-bottom: 10px;">
                        <strong>Value:</strong> $1.00 (‚Ç±60) per Pip.<br>
                        <em>Example: 154.25 ‚Üí 154.35 (10 Pips)</em>
                    </div>
                    <div
                        style="background: rgba(255,255,255,0.7); padding: 10px; border-radius: 8px; font-size: 0.95rem; display: flex; justify-content: space-between;">
                        <span style="color: #27ae60; font-weight: bold;">Profit: ‚Ç±600.00</span>
                        <span style="color: #7f8c8d;">(Nice lunch date)</span>
                    </div>
                </div>

                <!-- Standard -->
                <div class="lot-card"
                    style="border: 1px solid #f8bbd0; padding: 15px; border-radius: 15px; background: #fce4ec; transition: transform 0.2s;">
                    <div style="display:flex; align-items:center; gap:20px; margin-bottom:10px;">
                        <div style="font-size: 2.5rem;">üíé</div>
                        <div>
                            <h3 style="margin: 0; color: #c2185b;">Standard Lot (1.00)</h3>
                            <div
                                style="background: #333; color: #0f0; font-family: monospace; padding: 2px 8px; border-radius: 4px; display: inline-block; font-size: 0.8rem; margin-top: 4px;">
                                Input: 1.00</div>
                        </div>
                    </div>
                    <div style="font-size: 0.9rem; color: #555; margin-bottom: 10px;">
                        <strong>Value:</strong> $10.00 (‚Ç±600) per Pip.<br>
                        <em>Example: 154.25 ‚Üí 154.35 (10 Pips)</em>
                    </div>
                    <div
                        style="background: rgba(255,255,255,0.7); padding: 10px; border-radius: 8px; font-size: 0.95rem; display: flex; justify-content: space-between;">
                        <span style="color: #27ae60; font-weight: bold;">Profit: ‚Ç±6,000.00</span>
                        <span style="color: #7f8c8d;">(Bills paid!)</span>
                    </div>
                </div>

            </div>
        </div>

        <!-- Section 5: Safety Visuals (SL/TP) -->
        <div class="section-card">
            <h2>üõ°Ô∏è 5. Safety Tools (Visualized)</h2>
            <p>Wag "Bahala na si Batman". Set your limits!</p>

            <div
                style="position: relative; height: 200px; background: #f9f9f9; border-radius: 15px; border: 1px solid #eee; margin: 20px 0; overflow: hidden; box-shadow: inset 0 0 10px rgba(0,0,0,0.05);">
                <!-- TP Line -->
                <div style="position: absolute; top: 40px; left: 0; right: 0; border-top: 2px dashed #27ae60;"></div>
                <div
                    style="position: absolute; top: 20px; right: 10px; color: #27ae60; font-weight: bold; font-size: 0.8rem;">
                    üí∞ Take Profit (Auto-Close Winner)</div>

                <!-- Entry Line -->
                <div style="position: absolute; top: 100px; left: 0; right: 0; border-top: 2px solid #555;"></div>
                <div
                    style="position: absolute; top: 80px; left: 10px; color: #555; font-weight: bold; font-size: 0.8rem;">
                    üìç Entry Point (Start)</div>

                <!-- SL Line -->
                <div style="position: absolute; bottom: 40px; left: 0; right: 0; border-top: 2px dashed #e74c3c;"></div>
                <div
                    style="position: absolute; bottom: 20px; right: 10px; color: #e74c3c; font-weight: bold; font-size: 0.8rem;">
                    üõë Stop Loss (Auto-Close Loser)</div>

                <!-- The Trade Path (Visual curve) -->
                <svg width="100%" height="200" style="position: absolute; top:0; left:0; pointer-events: none;">
                    <defs>
                        <path id="tradePath" d="M0,100 Q150,50 300,100 T600,60" fill="none" stroke="#3498db"
                            stroke-width="3" stroke-dasharray="5,5" />
                    </defs>
                    <use href="#tradePath" />
                    <!-- Animated Dot -->
                    <circle r="6" fill="#3498db">
                        <animateMotion dur="4s" repeatCount="indefinite">
                            <mpath href="#tradePath" />
                        </animateMotion>
                    </circle>
                </svg>
            </div>

            <p style="font-size: 0.9rem; text-align: center; color: #888;">
                Ang SL (Red Line) ang sasalo sayo pag nahulog. Ang TP (Green Line) ang kukuha ng panalo pag lumipad.
            </p>
        </div>

        <!-- Section 6: Leverage (Where to find it?) -->
        <div class="section-card">
            <h2>‚öñÔ∏è 6. Leverage (The "Power-Up" Setting)</h2>
            <p>Tanong: <em>"Bawat trade ba namimili ako ng Leverage?"</em></p>
            <p><strong>Answer: Hindi!</strong> Sine-set ito usually <strong>pag-gawa mo ng account</strong> sa App. Para
                siyang "Difficulty Level" or "Character Class" na pinipili mo sa start ng game.</p>

            <!-- App UI Mockup -->
            <div
                style="background: #333; color: white; padding: 20px; border-radius: 15px; max-width: 350px; margin: 20px auto; font-family: sans-serif; border: 2px solid #555; box-shadow: 0 10px 20px rgba(0,0,0,0.2);">
                <div
                    style="text-align: center; margin-bottom: 20px; border-bottom: 1px solid #555; padding-bottom: 10px;">
                    <span style="color: #bbb; font-size: 0.8rem; letter-spacing: 1px;">OPEN NEW ACCOUNT</span>
                </div>

                <div style="margin-bottom: 15px;">
                    <label style="font-size: 0.7rem; color: #888; display: block; margin-bottom: 5px;">ACCOUNT
                        TYPE</label>
                    <div style="background: #444; padding: 10px; border-radius: 5px; font-size: 0.9rem; color: #eee;">
                        Standard Account ‚ñæ</div>
                </div>

                <div style="margin-bottom: 25px;">
                    <label style="font-size: 0.7rem; color: #2ecc71; display: block; margin-bottom: 5px;">LEVERAGE
                        (Select Power)</label>
                    <select id="leverage-select" onchange="updateAppLeverage()"
                        style="width: 100%; background: #222; color: #fff; border: 1px solid #2ecc71; padding: 10px; border-radius: 5px; font-size: 1rem; cursor: pointer; outline: none;">
                        <option value="1">1:1 (No Leverage - Safe)</option>
                        <option value="100" selected>1:100 (Standard - Balanced)</option>
                        <option value="500">1:500 (High Risk - Pro)</option>
                    </select>
                </div>

                <div style="background: linear-gradient(90deg, #2980b9, #3498db); text-align: center; padding: 12px; border-radius: 5px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: opacity 0.2s;"
                    onmouseover="this.style.opacity=0.9" onmouseout="this.style.opacity=1">
                    Create Trading Account
                </div>
            </div>

            <p style="text-align: center; font-size: 0.9rem; margin-top: 10px; color: #777;">(Once set, applied na ito
                sa buong account mo.)</p>

            <!-- Interaction Result -->
            <div id="leverage-effect-box"
                style="background: #e3f2fd; padding: 20px; border-radius: 15px; margin-top: 30px; border: 1px solid #bbdefb; transition: all 0.3s;">
                <h3 style="margin-bottom: 10px; color: #1565c0;">The Effect:</h3>

                <div
                    style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px;">
                    <div style="flex: 1; min-width: 150px;">
                        <p style="margin:0; font-size:0.9rem; color:#555;">Your Deposit:</p>
                        <div style="font-size: 1.5rem; font-weight: bold; color: #333;">‚Ç±5,000</div>
                    </div>

                    <div style="font-size: 2rem; color: #aaa;">üëâ</div>

                    <div style="flex: 1; min-width: 150px;">
                        <p style="margin:0; font-size:0.9rem; color:#555;">Buying Power:</p>
                        <div id="lev-power" style="font-size: 1.8rem; font-weight: bold; color: #2980b9;">‚Ç±500,000 ‚ö°
                        </div>
                    </div>
                </div>

                <p id="lev-desc"
                    style="font-size: 0.95rem; color: #444; margin-top: 15px; background: rgba(255,255,255,0.6); padding: 10px; border-radius: 8px;">
                    Dahil <strong>1:100</strong> ang napili mo, ang ‚Ç±5,000 mo ay may power na parang ‚Ç±500,000! Kaya mo
                    nang
                    mag-trade ng malalaking Lots.
                </p>
            </div>
        </div>

        <div style="text-align: center; margin-top: 50px; margin-bottom: 80px;">
            <a href="{{ url_for('chapter2') }}" class="next-chapter-btn">
                Complete Chapter 1 & Continue to Trends ‚Üí
            </a>
        </div>

    </div>

    <script>
        function updateAppLeverage() {
            const select = document.getElementById('leverage-select');
            const powerDisplay = document.getElementById('lev-power');
            const descDisplay = document.getElementById('lev-desc');
            const val = parseInt(select.value);

            let htmlContent = '';

            if (val === 1) {
                powerDisplay.innerHTML = '‚Ç±5,000 üê¢';
                htmlContent = `
                    <div style="text-align: left; margin-top: 10px;">
                        <div style="background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 10px; border: 1px dashed #aaa;">
                            <strong>üìâ Scenario: Small Market Move</strong><br>
                            <p style="margin: 5px 0 0; font-size: 0.9rem; color: #555;">
                                Sa Forex, kailangan mo ng minimum ‚Ç±50,000 (roughly $1,000) para makabili. Dahil ‚Ç±5,000 lang dala mo at walang leverage...
                            </p>
                            <p style="margin: 10px 0 0; font-weight: bold; color: #e74c3c;">
                                RESULT: You CANNOT Trade. ‚ùå
                            </p>
                            <p style="margin: 0; font-size: 0.85rem; color: #777;">(Parang pambili lang ng candy ang dala mo sa car dealership. Kulang.)</p>
                        </div>
                        <div style="background: rgba(149, 165, 166, 0.2); padding: 8px; border-radius: 6px; font-size: 0.85rem;">
                            <strong>‚ùå Cons:</strong> Stuck ka. Walang mangyayari sa account mo.
                        </div>
                    </div>`;
            } else if (val === 100) {
                powerDisplay.innerHTML = '‚Ç±500,000 ‚ö°';
                htmlContent = `
                    <div style="text-align: left; margin-top: 10px;">
                        <div style="background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #2980b9;">
                            <strong>üçî Scenario: SAME Small Market Move</strong><br>
                            <p style="margin: 5px 0 0; font-size: 0.9rem; color: #555;">
                                Dahil may leverage ka, nakasabay ka sa trade! Pag gumalaw ng onti ang market:
                            </p>
                            <p style="margin: 10px 0 0; font-weight: bold; color: #333;">
                                RESULT: Win/Loss = ‚Ç±600
                            </p>
                            <p style="margin: 0; font-size: 0.85rem; color: #7f8c8d;">(Presyong lunch out lang. Masaya pag panalo, di masyadong masakit pag talo.)</p>
                        </div>
                        <div style="background: rgba(52, 152, 219, 0.15); padding: 8px; border-radius: 6px; margin-bottom: 5px; font-size: 0.85rem;">
                            <strong>‚úÖ Pros:</strong> Sustainable. Pwede kang magtagal sa trading.
                        </div>
                    </div>`;
            } else if (val === 500) {
                powerDisplay.innerHTML = '‚Ç±2,500,000 üöÄ';
                htmlContent = `
                    <div style="text-align: left; margin-top: 10px;">
                        <div style="background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 10px; border: 2px solid #e74c3c;">
                            <strong>üé∞ Scenario: SAME Small Market Move</strong><br>
                            <p style="margin: 5px 0 0; font-size: 0.9rem; color: #555;">
                                Masyadong malaki ang leverage mo. Yung "Small Move" kanina, magnified ng 500x!
                            </p>
                            <p style="margin: 10px 0 0; font-weight: bold; color: #c0392b;">
                                RESULT: Win/Loss = ‚Ç±6,000
                            </p>
                            <p style="margin: 0; font-size: 0.85rem; color: #e74c3c;">(Isang galaw lang, pwedeng <strong>DOUBLE</strong> pera mo... or <strong>UBOS/ZERO</strong> agad.)</p>
                        </div>
                        <div style="background: rgba(231, 76, 60, 0.2); padding: 8px; border-radius: 6px; border: 1px solid #e74c3c; font-size: 0.85rem;">
                            <strong>‚ö† Warning:</strong> Ito ang reason bakit nasusunog ang mga baguhan. It's gambling, not trading.
                        </div>
                    </div>`;
            }

            descDisplay.innerHTML = htmlContent;
        }

        // Initialize on load
        window.onload = function () {
            updateAppLeverage();
            // Start fetch
            fetchLiveRate();
        };

        let liveRateValue = 0.38; // Default value if API fails

        async function fetchLiveRate() {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/JPY');
                const data = await response.json();
                liveRateValue = data.rates.PHP;

                const slider = document.getElementById('rate-slider');
                // Set flexible range approx +/- 20% around the live rate
                slider.min = (liveRateValue * 0.8).toFixed(3);
                slider.max = (liveRateValue * 1.2).toFixed(3);
                slider.value = liveRateValue.toFixed(3); // Set slider to live rate initially

                // Update Badges
                document.getElementById('live-rate-badge').innerText = "LIVE RATE: " + liveRateValue.toFixed(4);

                // Calculate and display value for 10,000 JPY
                const convertedVal = Math.floor(10000 * liveRateValue).toLocaleString();
                document.getElementById('live-converted').innerText = "(‚âà ‚Ç±" + convertedVal + ")";

                updateRemittance(); // Recalculate values based on initial slider value
            } catch (e) {
                console.log("Offline mode or API error", e);
                document.getElementById('live-rate-badge').innerText = "OFFLINE: " + liveRateValue.toFixed(3);
                document.getElementById('live-converted').innerText = "(‚âà --- PHP)";
                updateRemittance(); // Use default stats
            }
        }


        function completeChapter() {
            // Save Progress: 1 means Chapter 1 Done (Unlock Ch 2)
            let current = parseInt(localStorage.getItem('forex_progress') || 0);
            if (current < 1) {
                localStorage.setItem('forex_progress', 1);
            }
            // Navigate
            window.location.href = "{{ url_for('index', _anchor='map') }}";
        }

        function tilt(direction) {
            const plank = document.getElementById('seesaw-plank');
            const text = document.getElementById('seesaw-text');

            if (direction === 'left') {
                plank.classList.remove('plank-tilted-right');
                plank.classList.add('plank-tilted-left');
                text.innerHTML = '<span style="color:#e74c3c; font-size:1.2rem;">üáØüáµ JPY gets HEAVY! (Strong)</span> <br> The Chart goes UP! <br> You win because you trusted Japan.';
            } else {
                plank.classList.remove('plank-tilted-left');
                plank.classList.add('plank-tilted-right');
                text.innerHTML = '<span style="color:#3498db; font-size:1.2rem;">üáµüá≠ PHP gets HEAVY! (Strong)</span> <br> The Chart goes DOWN! <br> You win because you trusted Pinas (Bought PHP).';
            }
        }

        // Auto-wire the "Next Chapter" button if present
        window.addEventListener('load', () => {
            const nextBtn = document.querySelector('.next-chapter-btn');
            if (nextBtn) {
                nextBtn.onclick = function (e) {
                    e.preventDefault();
                    completeChapter();
                };
                // Also change text to "Complete Level 1 üèÜ"
                nextBtn.innerText = "Complete Level 1 üèÜ";
            }
        });

        // New Interactive Functions
        function updateRemittance() {
            const rate = parseFloat(document.getElementById('rate-slider').value);
            document.getElementById('rate-display').innerText = rate.toFixed(3);

            const jpy = 10000;
            const php = Math.floor(jpy * rate);
            const phpFormatted = php.toLocaleString();

            const resultEl = document.getElementById('php-result');
            const diffEl = document.getElementById('diff-badge');

            resultEl.innerText = "‚Ç±" + phpFormatted;

            // Calculate Difference from LIVE Rate
            // We use global variable liveRateValue. If not ready, it defaults to 0.38
            const basePhp = Math.floor(jpy * liveRateValue);
            const diff = php - basePhp;

            if (diff > 0) {
                diffEl.innerText = "+ ‚Ç±" + diff.toLocaleString();
                diffEl.style.background = "#e0f2f1";
                diffEl.style.color = "#00695c";
                diffEl.style.opacity = "1";
                resultEl.style.color = "#2ecc71";
            } else if (diff < 0) {
                diffEl.innerText = "- ‚Ç±" + Math.abs(diff).toLocaleString();
                diffEl.style.background = "#ffebee";
                diffEl.style.color = "#c62828";
                diffEl.style.opacity = "1";
                resultEl.style.color = "#e74c3c";
            } else {
                diffEl.style.opacity = "0"; // Hide if same
                resultEl.style.color = "#555";
            }

            // Pulse Animation
            resultEl.style.transform = "scale(1.1)";
            setTimeout(() => {
                resultEl.style.transform = "scale(1)";
            }, 100);

            const comment = document.getElementById('remittance-comment');

            // Humorous Taglish Logic
            if (rate >= 0.42) {
                comment.innerHTML = "üòç <strong>Sana All!</strong> Yamanin na. (Pang-Jollibee Party Package na 'to!)";
                comment.style.color = "#27ae60";
            } else if (rate >= 0.38) {
                comment.innerHTML = "üòê <strong>Pwede na.</strong> Sakto lang pambayad bills. (Normal Days)";
                comment.style.color = "#555";
            } else if (rate <= 0.34) {
                comment.innerHTML = "üò≠ <strong>Iyak Tawa.</strong> Ang sakit sa bangs. (Hold muna, wag magpapalit!)";
                comment.style.color = "#c0392b";
            } else {
                comment.innerHTML = " <strong>Bumaba ng slight.</strong> Tipid-tipid muna.";
                comment.style.color = "#d35400";
            }
        }


        function animateCandle(type) {
            const candle = document.getElementById('demo-candle');
            const explain = document.getElementById('candle-explain');

            // Reset slightly
            candle.style.height = '10px';
            candle.style.transform = 'scale(1)';
            candle.style.boxShadow = 'none';
            explain.style.borderLeft = "none";

            setTimeout(() => {
                if (type === 'green') {
                    candle.style.background = '#2ecc71';
                    candle.style.height = '100px';
                    candle.style.boxShadow = '0 0 20px rgba(46, 204, 113, 0.5)';
                    explain.innerHTML = "Buyers pushed price <strong>UP</strong>! üöÄ <br>Started low, ended high.";
                    explain.style.borderLeft = "5px solid #2ecc71";
                } else {
                    candle.style.background = '#e74c3c';
                    candle.style.height = '100px';
                    candle.style.boxShadow = '0 0 20px rgba(231, 76, 60, 0.5)';
                    explain.innerHTML = "Sellers pushed price <strong>DOWN</strong>! üìâ <br>Started high, ended low.";
                    explain.style.borderLeft = "5px solid #e74c3c";
                }
            }, 50);
        }
    </script>
    <!-- Scroll Focus Animation Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cards = document.querySelectorAll('.section-card');

            const observerOptions = {
                root: null,
                rootMargin: '-20% 0px -20% 0px', // Activate when element is in middle 60% of screen
                threshold: 0.3 // Trigger when 30% visible within that rootMargin
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // Add focus to current
                        entry.target.classList.add('focused');
                    } else {
                        // Remove focus when scrolling away
                        entry.target.classList.remove('focused');
                    }
                });
            }, observerOptions);

            cards.forEach(card => observer.observe(card));
        });
    </script>
</body>

</html>